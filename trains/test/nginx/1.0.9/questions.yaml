groups:
  - name: App Configuration
    description: Configure App for Nginx
  - name: Storage Configuration
    description: Configure Storage for Nginx
  - name: Network Configuration
    description: Configure Network for Nginx

questions:
  - variable: app
    label: App
    group: App Configuration
    schema:
      type: dict
      attrs:
        - variable: additional_csp_strings
          label: Additional Content Security Policy (List of Strings)
          description: |
            Additional Content Security Policy directives to add to the default CSP.</br>
            These will be merged with the default CSP directives.</br>
            Only add here directives/items that are not already present in the CSP File (/etc/opencloud/csp.yaml).</br>
            If you notice a directive/item is missing that affects the core functionality of OpenCloud, </br>
            or any of the integrations configured via this UI, please open an issue on GitHub.</br>
            CSP keywords should be enclosed in single quotes.</br>
            Example: `'unsafe-eval'`
          schema:
            type: list
            default:
              - directive: connect-src
                items:
                  - https://raw.githubusercontent.com/opencloud-eu/awesome-apps/
                  - https://update.opencloud.eu/
              - directive: frame-src
                items:
                  - https://embed.diagrams.net/
              - directive: img-src
                items:
                  - https://raw.githubusercontent.com/opencloud-eu/awesome-apps/
                  - https://tile.openstreetmap.org/
            items:
              - variable: csp_entry
                label: Content Security Policy Entry
                schema:
                  type: dict
                  attrs:
                    - variable: directive
                      label: Directive
                      schema:
                        type: string
                        required: true
                        enum:
                          - value: child-src
                            description: child-src
                          - value: connect-src
                            description: connect-src
                          - value: default-src
                            description: default-src
                          - value: font-src
                            description: font-src
                          - value: frame-ancestors
                            description: frame-ancestors
                          - value: frame-src
                            description: frame-src
                          - value: img-src
                            description: img-src
                          - value: manifest-src
                            description: manifest-src
                          - value: media-src
                            description: media-src
                          - value: object-src
                            description: object-src
                          - value: script-src
                            description: script-src
                          - value: style-src
                            description: style-src
                    - variable: items
                      label: Items
                      schema:
                        type: list
                        items:
                          - variable: item
                            label: Item
                            schema:
                              type: string
                              required: true
                              default: ""
        - variable: additional_csp_objects
          label: Additional Content Security Policy (List of Objects)
          description: |
            Additional Content Security Policy directives to add to the default CSP.</br>
            These will be merged with the default CSP directives.</br>
            Only add here directives/items that are not already present in the CSP File (/etc/opencloud/csp.yaml).</br>
            If you notice a directive/item is missing that affects the core functionality of OpenCloud, </br>
            or any of the integrations configured via this UI, please open an issue on GitHub.</br>
            CSP keywords should be enclosed in single quotes.</br>
            Example: `'unsafe-eval'`
          schema:
            type: list
            default:
              - directive: connect-src
                items:
                  - value: https://raw.githubusercontent.com/opencloud-eu/awesome-apps/
                  - value: https://update.opencloud.eu/
              - directive: frame-src
                items:
                  - value: https://embed.diagrams.net/
              - directive: img-src
                items:
                  - value: https://raw.githubusercontent.com/opencloud-eu/awesome-apps/
                  - value: https://tile.openstreetmap.org/
            items:
              - variable: csp_entry
                label: Content Security Policy Entry
                schema:
                  type: dict
                  attrs:
                    - variable: directive
                      label: Directive
                      schema:
                        type: string
                        required: true
                        enum:
                          - value: child-src
                            description: child-src
                          - value: connect-src
                            description: connect-src
                          - value: default-src
                            description: default-src
                          - value: font-src
                            description: font-src
                          - value: frame-ancestors
                            description: frame-ancestors
                          - value: frame-src
                            description: frame-src
                          - value: img-src
                            description: img-src
                          - value: manifest-src
                            description: manifest-src
                          - value: media-src
                            description: media-src
                          - value: object-src
                            description: object-src
                          - value: script-src
                            description: script-src
                          - value: style-src
                            description: style-src
                    - variable: items
                      label: Items
                      schema:
                        type: list
                        items:
                          - variable: item
                            label: Item
                            schema:
                              type: dict
                              attrs:
                                - variable: value
                                  label: Value
                                  schema:
                                    type: string
                                    required: true
                                - variable: placeholder
                                  label: ""
                                  schema:
                                    type: string
                                    default: ""
                                    hidden: true
  - variable: storage
    label: ""
    group: Storage Configuration
    schema:
      type: dict
      attrs:
        - variable: data_dirs
          label: Data Directories
          schema:
            type: list
            default:
              - type: ix_volume
                mount_path: /data1
                ix_volume_config:
                  dataset_name: data1
            items:
              - variable: item
                label: ""
                schema:
                  type: dict
                  attrs:
                    - variable: type
                      label: Type
                      description: |
                        ixVolume: Is dataset created automatically by the system.</br>
                        Host Path: Is a path that already exists on the system.
                      schema:
                        type: string
                        required: true
                        default: host_path
                        enum:
                          - value: host_path
                            description: Host Path (Path that already exists on the system)
                          - value: ix_volume
                            description: ixVolume (Dataset created automatically by the system)
                    - variable: mount_path
                      label: Mount Path
                      description: The path inside the container to mount the storage.
                      schema:
                        type: path
                        required: true
                        default: /data1
                    - variable: host_path_config
                      label: Host Path Configuration
                      schema:
                        type: dict
                        show_if: [["type", "=", "host_path"]]
                        attrs:
                          - variable: acl_enable
                            label: Enable ACL
                            description: Enable ACL for the storage.
                            schema:
                              type: boolean
                              default: false
                          - variable: acl
                            label: ACL Configuration
                            schema:
                              type: dict
                              show_if: [["acl_enable", "=", true]]
                              attrs: []
                              $ref:
                                - "normalize/acl"
                          - variable: path
                            label: Host Path
                            description: The host path to use for storage.
                            schema:
                              type: hostpath
                              show_if: [["acl_enable", "=", false]]
                              required: true
                    - variable: ix_volume_config
                      label: ixVolume Configuration
                      description: The configuration for the ixVolume dataset.
                      schema:
                        type: dict
                        show_if: [["type", "=", "ix_volume"]]
                        $ref:
                          - "normalize/ix_volume"
                        attrs:
                          - variable: acl_enable
                            label: Enable ACL
                            description: Enable ACL for the storage.
                            schema:
                              type: boolean
                              default: false
                          - variable: dataset_name
                            label: Dataset Name
                            description: The name of the dataset to use for storage.
                            schema:
                              type: string
                              required: true
                              default: "data1"
                          - variable: acl_entries
                            label: ACL Configuration
                            schema:
                              type: dict
                              show_if: [["acl_enable", "=", true]]
                              attrs: []
                              $ref:
                                - "normalize/acl"
  - variable: network
    label: ""
    group: Network Configuration
    schema:
      type: dict
      attrs:
        - variable: web_port
          label: WebUI Port
          description: The port for Nginx WebUI
          schema:
            type: int
            default: 8080
            required: true
        - variable: some_new_field
          label: Some New Field
          description: Some new field
          schema:
            type: int
            default: 0
            required: true
