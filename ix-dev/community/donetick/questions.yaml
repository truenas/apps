groups:
  - name: Donetick Configuration
    description: Configure Donetick
  - name: Network Configuration
    description: Configure network access for Donetick
  - name: Storage Configuration
    description: Configure storage for Donetick

questions:
  - variable: donetick
    label: ""
    group: Donetick Configuration
    schema:
      type: dict
      attrs:
        - variable: jwt_secret
          label: JWT Secret (optional)
          description: |
            Leave empty to auto-generate a strong secret at deploy time, or set your own secure value (>=32 chars). If provided, it will be stored as DT_JWT_SECRET and in the generated config.
          schema:
            type: string
            default: ""

  - variable: network
    label: ""
    group: Network Configuration
    schema:
      type: dict
      attrs:
        - variable: web_port
          label: WebUI Port
          schema:
            type: dict
            attrs:
              - variable: bind_mode
                label: Port Bind Mode
                description: |
                  The port bind mode.</br>
                  - Publish: The port will be published on the host for external access.</br>
                  - Expose: The port will be exposed for inter-container communication.</br>
                  - None: The port will not be exposed or published.</br>
                  Note: If the Dockerfile defines an EXPOSE directive,
                  the port will still be exposed for inter-container communication regardless of this setting.
                schema:
                  type: string
                  default: "published"
                  enum:
                    - value: "published"
                      description: Publish port on the host for external access
                    - value: "exposed"
                      description: Expose port for inter-container communication
                    - value: ""
                      description: None
              - variable: port_number
                label: Port Number
                schema:
                  type: int
                  default: 2021
                  min: 1
                  max: 65535
                  required: true
              - variable: host_ips
                label: Host IPs
                description: IPs on the host to bind this port
                schema:
                  type: list
                  show_if: [["bind_mode", "=", "published"]]
                  default: []
                  items:
                    - variable: host_ip
                      label: Host IP
                      schema:
                        type: string
                        required: true
                        $ref:
                          - definitions/node_bind_ip

  - variable: storage
    label: ""
    group: Storage Configuration
    schema:
      type: dict
      attrs:
        - variable: base_host_path
          label: Host Dataset Path
          description: Base dataset path on the host to store Donetick configuration and data.
          schema:
            type: hostpath
            required: true
            default: /mnt/tank/apps/donetick
