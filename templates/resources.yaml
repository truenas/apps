- variable: resources
  label: Resources
  description: |
    The resources allocated to the container
  schema:
    type: dict
    attrs:
      - variable: limits
        label: Limits
        description: |
          The maximum amount of resources that can be allocated
        schema:
          type: dict
          attrs:
            - variable: cpu
              label: CPU
              description: The maximum amount of CPU cores that can be allocated
              schema:
                type: string
                # https://regex101.com/r/a4xrjj/1
                valid_chars: '^[0-9]+(\.[0-9]{1,4})?$'
                # https://docs.docker.com/compose/compose-file/deploy/#cpus
                valid_chars_error: |
                  Valid CPU limit formats are:</br>
                    - Plain Integer - eg. 4</br>
                    - Float - eg. 0.5</br>
                  Up to 4 decimal places are supported
                default: "4.0"
                required: true
            - variable: memory
              label: Memory
              description: The maximum amount of memory that can be allocated
              schema:
                type: string
                # https://regex101.com/r/OAFKte/1
                valid_chars: "^[1-9][0-9]*(k|m|g)b$"
                # https://docs.docker.com/compose/compose-file/deploy/#memory
                valid_chars_error: |
                  Valid memory limit formats are:</br>
                    - KiloBytes - eg. 1000kb</br>
                    - MegaBytes - eg. 1000mb</br>
                    - GigaBytes - eg. 1000gb</br>
                default: "8gb"
                required: true
      - variable: reservations
        label: Reservations
        description: |
          The amount of resources reserved
        schema:
          type: dict
          attrs:
            - variable: devices
              label: Device
              schema:
                type: list
                items:
                  - variable: device_ids
                    label: IDs
                    schema:
                      type: list
                      default: []
                      items:
                        - variable: id
                          label: ID
                          schema:
                            type: string
                            default: ""
                            # TODO: Use $ref here to populate IDs
                            required: true
